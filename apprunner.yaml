version: 1.0
runtime: python3

build:
  commands:
    - pip install --upgrade pip
    - pip install -r requirements.txt
    - python manage.py collectstatic --noinput
    - python manage.py migrate --noinput

run:
  command: gunicorn config.wsgi:application --bind 0.0.0.0:$PORT
  network:
    port: 8000
  env:
    DJANGO_SETTINGS_MODULE: config.settings
    PYTHONUNBUFFERED: "1"

environment:
  variables:
    DJANGO_SECRET_KEY: ${DJANGO_SECRET_KEY}
    DEBUG: "False"
    POSTGRES_DB: ${POSTGRES_DB}
    POSTGRES_USER: ${POSTGRES_USER}
    POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
    POSTGRES_HOST: ${POSTGRES_HOST}
    POSTGRES_PORT: "5432"
    EMAIL_HOST_USER: ${EMAIL_HOST_USER}
    EMAIL_HOST_PASSWORD: ${EMAIL_HOST_PASSWORD}
    DEFAULT_FROM_EMAIL: ${DEFAULT_FROM_EMAIL}
